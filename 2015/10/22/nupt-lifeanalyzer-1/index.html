<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="0x00 序Bad day.早上到公司，停自行车的时候，电脑包摔到了地上。原本出门检查好盖好的茶杯打开了，电脑进了水。由于没什么经验，多次尝试开机，把硬盘和显示屏烧坏了。数据恢复的价格并不能接受，本来快完成的项目得从头开始写了，也罢，刚好重头开始理理这个项目。切记今后做好备份啊！！！
0x01 准备OS: 工作需要，用的kali 2.0IDE: PyCharm Professional 试用版，到">
<meta property="og:type" content="article">
<meta property="og:title" content="NuptLifeAnalyzer札记（1）—— Reboot">
<meta property="og:url" content="http://blog.jerrywin.com/2015/10/22/nupt-lifeanalyzer-1/index.html">
<meta property="og:site_name" content="/home/jerrypy">
<meta property="og:description" content="0x00 序Bad day.早上到公司，停自行车的时候，电脑包摔到了地上。原本出门检查好盖好的茶杯打开了，电脑进了水。由于没什么经验，多次尝试开机，把硬盘和显示屏烧坏了。数据恢复的价格并不能接受，本来快完成的项目得从头开始写了，也罢，刚好重头开始理理这个项目。切记今后做好备份啊！！！
0x01 准备OS: 工作需要，用的kali 2.0IDE: PyCharm Professional 试用版，到">
<meta property="og:updated_time" content="2016-11-10T15:46:33.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="NuptLifeAnalyzer札记（1）—— Reboot">
<meta name="twitter:description" content="0x00 序Bad day.早上到公司，停自行车的时候，电脑包摔到了地上。原本出门检查好盖好的茶杯打开了，电脑进了水。由于没什么经验，多次尝试开机，把硬盘和显示屏烧坏了。数据恢复的价格并不能接受，本来快完成的项目得从头开始写了，也罢，刚好重头开始理理这个项目。切记今后做好备份啊！！！
0x01 准备OS: 工作需要，用的kali 2.0IDE: PyCharm Professional 试用版，到">
    
    
        <link rel="icon" type="image/png" href="/images/favicon.png" sizes="32x32" />
    
    <!-- title -->
    <title>NuptLifeAnalyzer札记（1）—— Reboot</title>
    <!-- styles -->
    <link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/lib/meslo-LG/styles.css">
    <link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
    <!-- jquery -->
    <script src="/lib/jquery/jquery.min.js"></script>
</head>

<body>
    <div class="content post width mx-auto px2 my4">
  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <span class="top-subtitle">
          <a href="/archives">Writing</a>
      </span>
      
    <h1 class="posttitle" itemprop="name headline">
        NuptLifeAnalyzer札记（1）—— Reboot
    </h1>



      <div class="meta">
          <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
              <span itemprop="name">jerrypy</span>
          </span>
          
    <div class="postdate">
        <time datetime="2015-10-22T02:26:56.000Z" itemprop="datePublished">2015-10-22</time>
    </div>


          
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Flask/">Flask</a>, <a class="tag-link" href="/tags/LifeAnalyzer/">LifeAnalyzer</a>, <a class="tag-link" href="/tags/Python/">Python</a>, <a class="tag-link" href="/tags/Web/">Web</a>
    </div>


      </div>
    </header>
    

    <div class="content" itemprop="articleBody">
      <h3 id="0x00-序"><a href="#0x00-序" class="headerlink" title="0x00 序"></a>0x00 序</h3><p>Bad day.<br>早上到公司，停自行车的时候，电脑包摔到了地上。原本出门检查好盖好的茶杯打开了，电脑进了水。由于没什么经验，多次尝试开机，把硬盘和显示屏烧坏了。数据恢复的价格并不能接受，本来快完成的项目得从头开始写了，也罢，刚好重头开始理理这个项目。<br><br><strong>切记今后做好备份啊！！！</strong><br></p>
<h3 id="0x01-准备"><a href="#0x01-准备" class="headerlink" title="0x01 准备"></a>0x01 准备</h3><p><strong>OS</strong>: 工作需要，用的kali 2.0<br><br><strong>IDE</strong>: PyCharm Professional 试用版，到期再说<br><br><strong>Python</strong>: 2.7<br></p>
<ul>
<li>没有可用的版本控制服务器，备份暂时就放移动硬盘里吧。</li>
<li><p><code># vitualenv NUPTLifeAnalyzer</code></p>
<ul>
<li>创建virtualenv的时候还碰到个莫名其妙的问题，工作环境设置了<code>PYTHONOPTIMIZE=1</code>参数，导致virtualenv出现<br><code>ImportErrot: Bad magic number</code>的错误。<br>具体见<a href="https://github.com/pypa/virtualenv/issues/435" target="_blank" rel="external">https://github.com/pypa/virtualenv/issues/435</a></li>
</ul>
<p>这个项目基本上跟着<a href="http://blog.miguelgrinberg.com/index" target="_blank" rel="external">Miguel Grinberg</a>的<a href="http://www.amazon.cn/Flask-Web%E5%BC%80%E5%8F%91-%E5%9F%BA%E4%BA%8EPython%E7%9A%84Web%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98-%E6%A0%BC%E6%9E%97%E5%B8%83%E6%88%88/dp/B00QT2TQCG/ref=sr_1_1?ie=UTF8&amp;qid=1444465311&amp;sr=8-1&amp;keywords=flask" target="_blank" rel="external">《Flask Web开发:基于Python的Web应用开发实战》</a>一书完成。</p>
</li>
</ul>
<h3 id="0x02-考虑"><a href="#0x02-考虑" class="headerlink" title="0x02 考虑"></a>0x02 考虑</h3><p> 项目名字还没有确定，只有个开发名，叫Life Analyzer,希望用户使用的时候，能唤起一些回忆，珍惜接下来的大学生活。UI考虑使用<a href="http://designmodo.com/flat-free" target="_blank" rel="external">Flat UI</a>,扁平化的风格，配色看起来比较温暖。<br><br> 项目大致架构是，Web server用的nginx，进程管理使用supervisor,应用服务器使用gunicorn,任务队列使用Celery,消息传输、celery result backend、缓存、flask session都使用Redis，数据库使用MongoDB。也没有什么特别的原因，都是初学，选了些当下比较流行的组件来使用。<br><br> LifeAnalyzer基本上只有一个入口，所以最大的性能问题，应该就是防D了。这也是我想用Celery的原因，相同的学号只需要一个任务，大家都来取这个任务的结果就可以了。<br> 还有其它一些基本的安全问题，越权访问其它用户数据等等。</p>
<h3 id="0x03-启程"><a href="#0x03-启程" class="headerlink" title="0x03 启程"></a>0x03 启程</h3><h4 id="开发环境"><a href="#开发环境" class="headerlink" title="开发环境"></a>开发环境</h4><p> 首先把开发环境搭起来吧。mongo安装参考<a href="https://docs.mongodb.org/manual/tutorial/install-mongodb-on-debian/" target="_blank" rel="external">官方教程</a>。没有做分布式，mongo和redis只开放本机访问就可以了，做权限认证的话当然更好，mongo 3.0+的添加用户改成了<code>createUser</code>而不是之前的<code>addUser</code>了。</p>
<h4 id="celery-queue设计"><a href="#celery-queue设计" class="headerlink" title="celery queue设计"></a>celery queue设计</h4><p> 正方登录、正方爬虫、图书馆爬虫、校园卡爬虫分别跑在不同的Queue当中，方便启动和停止。</p>
<h4 id="数据库设计"><a href="#数据库设计" class="headerlink" title="数据库设计"></a>数据库设计</h4><p> mongo的文档模型还是非常自由的，我们的数据库也不是特别复杂。mongo3弃用了<code>padding factor</code>标识，采用<a href="https://docs.mongodb.org/v3.0/core/storage/#power-of-2-allocation" target="_blank" rel="external">2的幂分配</a>策略。尽量保持各collection大小相近就好。</p>
<h4 id="前端设计"><a href="#前端设计" class="headerlink" title="前端设计"></a>前端设计</h4><p> 慢慢开始学js啦，这个边做边看吧。</p>
<p> 好啦，开始启动吧！</p>

    </div>
  </article>
  
    <div class="blog-post-comments">
        <!--<div id="disqus_thread">
           <!--  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <!-- </div> -->
        
                <section id="comments">
                    <div class="ds-thread" data-thread-key="post-nupt-lifeanalyzer-1" data-title="NuptLifeAnalyzer札记（1）—— Reboot" data-url="http://blog.jerrywin.com/2015/10/22/nupt-lifeanalyzer-1/"></div>
                </section>
        
    </div>


</div>

    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2017 /home/jerrypy
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <li><a href="/">Home</a></li>
        <li><a href="/archives">Writing</a></li>
        <li><a href="http://github.com/jerrypy">Projects</a></li>
      </ul>
    </nav>
  </div>
</footer>

    <script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- Google Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'jerrypyblog';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


  <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
      <script type="text/javascript">
          var duoshuoQuery = {short_name:'jerrypyblog'};
      (function() {
               var ds = document.createElement('script');
                       ds.type = 'text/javascript';ds.async = true;
                               ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
                                       ds.charset = 'UTF-8';
                                               (document.getElementsByTagName('head')[0] 
                                                         || document.getElementsByTagName('body')[0]).appendChild(ds);
                                                     })();
      </script>
          <!-- 多说公共JS代码 end -->

</body>
</html>
